Logbook, aka what did I do, a bit late to start this but here we go:

previously:
switched to maven
implemented eventbus to at least show the weather images
animation system for weather async might be working properly.
how to do this for sync? does the code work as well?
animating players - how could this even work? Does the thread know all animateable objects and just iterate over them and do the switch case?
Getting Tiles defined properly on the screen, not as simple graph lines, but as objects whith tool tips
moving the player around the screen as turn action
moving the focus along with the player, so player stays in center
adding sound
adding map changes
adding animated tiles

History of the changes:
2020-05-24: finally made log4j2 work at least in the basic version. what was wrong? I just did not read the tutorial very carefully.
2020-05-25: just added eventbus to randomanimationsystem. will need to use this one, everything else is not feasible at all.
2020-05-26: i was being lazy today, only added positon to player as I will need to get a position on the map somehow.
2020-05-27: thought about game map, position and player position a bit. 
			Added players to the Map as well. 
			No, wait, dont need to. 
			stumbled over 
			https://stackoverflow.com/questions/17916057/tile-drawing-on-canvas-based-on-file-with-ints 
			this pretty much answers my questions and will make things easier. a lot easier.
2021-05-03:	and I have this kind of running again on new hardware with even faster hardware, and Maven rocks, as it automatically downloaded everything.
			I am in love with Maven.
			Something is not yet working completely, but oh well, good enough for half an hours work.
2021-05-26:	So sometime in the past, I redid the security policy cause it was missing, re-added the splash window and tried to get everything in the workspace.
			Idea how to deal with players - actor images are all handled via animation thread. this means that it should be possible to have multiple changes 
			during the same animation cycles.
			the position of the player - not the image will decide where to draw the image in the end.
2021-05-29:	So I played around some time again with threading and keyboard/mouse interface - and i dont really understand either.
			There are no mouse events caught, no keyboard events caught, this is interesting.
			Threading is a huge topic of course, but it does not matter much really.
			performance and things like that are a million years from being important.
2021-09-16:	So the days are getting shorter and I have a little bit of more time - switched gridcanvas to swing, probably a better way to do things.
			It appears I do not comprehend my setup anymore. I have a Game, the game has players, I can iterate over them, but the toString method returns zilch?
			so lo and behold, i have made progress, basically i just take the player number, put the current image into a list on the canvas, so there is only
			one active image per player on the canvas, if that changes in the animation code, message is sent, canvas is redrawn completely.
			It appears the JPanel is better suited and less flashy.
			So, now its really off to keyboard control isnt it?
			https://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html
			OK, so the gridcanvas has focus
2021-12-30:	Adding a border to check the focus of the grid canvas, will need to calculcate grid and grid sizes somehow soon
2022-01-06:	so added a simple grid to the visible JGridCanvas. Tomorrow I will think about having a turn loop (game thread?)
			which waits for input, i.e. Action then the next player is being triggered.
			If this works, adapt the player position with the action.
			if this works, get the player position to be calculated on the screen.
			if this works, get the player image being recalculated each time the animation thread runs.
2022-01-09:	so player position is being updated now already.
			player is moving
			currently whole component is redrawn
			not sure how this will work
			need to look into drawing background image and drawing player on it.
			the rest works, so happy :D:D:D
			so tried to center the player graphics with tile size 32 and image size 16. this works, but it is a bit icky. would like to better calculate this.
			Also, calculating this each time an image is drawn. probably something to figure out during game start in a separate module and then only use
			set properties.
			next stop: drawing player image over background colours.
			further stop: position stored on the player or on the map?
			ok, you can create images from pixels, thats great, but it appears pixels and borders do not really work or i am stupid.
			but I need to draw some more images first: grasslands, mountain, river, sea, swamp, hills.
2022-01-10:	so the images are now rendered into transparent. ImageIcon and ImageIO ... the ways paths are handled, it is a nightmare.
			these are the things where java sucks, really sucks.
2022-01-11:	refactoring Player a little bit - image handling is now in ImageUtils. hopefully to be used once I add environment and random movement.
			ideas for that: random movement in all directions, if player is already there, do not move in that direction.
			if obstacle is also there, do not move.
			if three places from original spawn spot has been reached, do not move away but only move closer anymore.
			?
2022-01-12:	maven update - not sure why this is not working properly, in my book, if i click on "update" it should update.
			Awesome, so I have two players moving on the map and the map grids have colors :D:D:D
			So basically, now I can draw background terrain icons
			did something small in addition: loaded sun image as icon for taskbar and frame.
			Nice? No, working? Sure.
			Changed Game to be a Singleton, can go through a lot of code and take away game as reference.
			Probably not needed anywhere for Game.getCurrent() will return the same thing.
2022-01-13:	So needed to break up the game startup into more pieces, as doing all in the constructor leads to all kinds of problems
			if you want to work with a singleton.
			but that is fixed. also there are basically three different lists now.
			list for players - awaiting keyboard commands
			list for npcs - doing random events
			list for both - used in animation system to have it running
			i should switch to no animation system or simple animation system to see where this breaks :D
			npcs on the map and environment act now before the turn is advanced.
			need to think of a way to store all possible actions in an action to have a complete "retract turn"
2022-01-14:	so the UI has now an undo button which calls simply "retract turn" - this leads now to interesting errors
			so the turn already rolls over automatically.
			so 1st movement happens in turn 0,
			then in turn 1, we retract.
			then we are in turn 0 again,
			and take the actions and invert all the actions, kind of.
2022-01-15:	some refactoring happened. All Entities support doAction() now. 
			Only PC is player character now.
			NPCs are separate.
			World is separate as well.
2022-01-16:	There is a map creation now which creates 12x12 of type Type.
			This is the the basis for moving 5x5 grid over the map with the PC staying in the center.
			added VM parameter for quicker startup.
2022-01-17:	So EventBus events are being called only if the UI exists.
			moved weather system into its own startup method.
			Need to figure out how to start with weather already called and visible instead of having null weather and then adding it later on.
			Big to do: always have pc center in the center.
			So Ocean Images are created with curvedlines in a function.
			Might need to do this only once at startup and add to maptile as representation?
2022-01-19:	So tried changing the UI Code to actually standard Swing. I have no idea why this was working in the first place.
			Now it appears to be standard Swing code, and it isnt working anylonger.
2022-01-20:	partial rollback: "MainWindow" which is basically the Listener(Controller) class is back in action. MainFrame exists also.
			No content pane and all controls are added to the frame in the listener class.
			Controller class still exists but I need to ask myself why.
			So MainWindow is now controller class and also UI Building Class - strikes me as very odd, but hey its working.
			Also, the minor changes to Weather/WeatherSystem/JWeatherCanvas lead to the weather appearing right away.
			Perhaps there needs to be a check whether the UI is completely there, before firing messages over EventBus.
			But that is to do. Still need to ask someone as to how the build order for a swing UI should actually be,
			or perhaps what to use for stuff like this anyhow. AWT is out, SWT is also out. JavaFX is ... weird.
			So on a positive note, I have learned a few things how not to do it for now.
			Added Minimal cursor change for the mouse and added mouselisteners and mousemove listeners.
			To do Cursor: calculate where the cursor is compared to the center of the tile the player is on.
			Either mathematical or with if, else and then update the cursor to the correct arrow.
			So, inital cursorDraw was a little bit too small, but in theory, everything works.
			So, I can either find icons, or draw all 8 on my own, or draw one and rotate it in 45 degree steps, either 
			from scratch in memory or write to disk, or both.
2022-01-21:	So I have a kind of working cursor.
			Generated images are not working yet.
			Cursor is moving in corridors according to movement, as there is only n,e,s,w movement. actor already moves on the screen.
			However, turn advancement and so on is not really handled yet, needs to be done.
2022-01-22:	so mouse clicked is working, with history, turn advancement and so on.
			however, the cursor does not update properly if the PC moves past the cursor. Problem here happening.
			TODOs:
			Implement timers for pass turn and for pressed event.
			I really do not want to deal with the map movement :D
			Something for tomorrow probably.
2022-01-24:	So remove clicked event and deal with "mouse pressed" and "mouse released" works way better.
			A simple swing timer takes care of this now.
			This is not super elegant yet.
			Moving the mouse while pressed will not make it go into the other direction, but it does not matter yet.
			progress!
			Passing a turn also now works as well with a swing timer. Fuck the rest, its working.
			You can even retract the pass actions :D:D:D:D:D
2022-01-25:	not wanting to deal with the map to position calculation.
			I am looking for other things to deal with.
			Might start working on the text interface, to fuck up the UI again.
			So InputFields are appearing, they look awful, but good for a start.
2022-01-26: retracting inputfield works fine now.
			So mouse cursors are created manually now.
			MouseDragged event needed to be caught, but:
			It is necessary to make the left right top bottom calculation a little bit more lenient.
			WeatherCanvas is still taking about the whole contentPane, I do not understand why this is the case yet.
			But I guess, in the course of a real UI, this will go away eventually.
			Added inventory and space as actions with inventory not being an action but opening a dialog instead.
			Z will probably also lead to z-stats (in the old ultima way)
2022-01-27:	So created AbstractDialog with ZStatsDialog and InventoryDialog. 
			Trying to get a Button to appear, but it appears I am too stupid for Swing.
2022-01-28:	So I tried to dabble with some music playing and it appears with the help of stackoverflow this is rather easy
			Java FX appears to be helpful for a change.
			Need to figure out how to do a loop, but random selection of ultima IV and V Songs will work fine.
			So music selection is interesting. Not sure how to do this properly.
			Something for tomorrow. I am content with the progress.
2022-01-29:	So music is now running. Clips does not help, needed to switch to code creating SourceDataLine instead.
			Why? clip is probably not thread-safe or anything. This works.
			To do here is to tag songs and have certain actions in the game also trigger a change of music.
			But much progress with little stackoverflow lookup.
			Small To do here: stop music when deactivated or iconofied and restart when active again.
2022-01-30:	So the solution for WeatherCanvas misbehaving was the default LayoutManager.
			Setting this to null worked wonders. Still not working for the dialogs.
			So music is only stopped if the game is deactivated / iconofied, not if a dialog is opened.
			Same thing needs to happen with animation, but I think this can be continuously drawn offscreen.
2022-01-31:	starting Map to UI Position calculation. Doing a save first online.
2022-02-01: so recalculating the map coordinates almost, almost works. Not sure yet where the error is.
			Not sure whether I actually need to lens and the list of tiles, but its easier to work with if the filtering is correct.
			IF the filtering is correct, not sure yet whether this is the case.	
2022-02-02: So the scrolling works, positioning the Player and the NPCs on the tiles does not work yet.
			For some reason, mouse and keyboard input is broken, but I think this is a question of the hard hard logging now.
2022-02-03:	I got the positioning somewhat correct, with the borders being drawn black if there is no more content.
			Can definitely be used for LoS, for indoor maps.
2022-02-04:	So there is an issue with idling - a space idle even does not lead to an action that is logged, at least not in the log.
			Also, the positioning of NPCs appears to be off for whatever reason. Not on the map, on the UI of course.
			More to be done tomorrow morning there.
			Next topics: Perhaps think about changing Map to current map and thinking about entering areas.
			XML needs to be extended for this, also need an series of images.
			Need:
			- which map this goes to
			- where on the map this goes to
			- how it goes back
			- is it indoors?
			- if in town, is there rain?
			- think about adding weather effects in a animated thread but only regularly going through the images instead of random like for NPCs and Player
2022-02-06:	so multiple things happened today in a couple of hours:
			1. Map Offset and UI offset are solved, with a lot less code than before
			2. the lense is gone again so to speak, might come back for LoS
			3. background images are only loaded once now
			4. background images are on a separate thread now and not random but morosely cycling through the images
			5. we have a huge 111x111 map now. loading this actually takes a second
			6. game has a current map now which for starting is of course the game map
			7. still thinking about adding rain or snow animations now over the map into the foreground with transparent images, or calculate the drops on the fly?
			lots of success today, I am very happy with this progress - I stumble over smaller language issues on my side, but well
			So did some more work in the evening, thinking about how to implement blocking tiles.
			Type will block tiles, as will setMapPosition(), as will movement.
			There is a bug in lookahead but I do not recognize this now. Time for bed zzZzz.
2022-02-07:	found the bug: 1. lookAhead returns false if not blocked. also one direction had a copy and paste error.
			so I have reworked Map and GameMap now - I am actually not sure why I keep GameMap, this might go and be kept in a variable in Game.
			Moving to the new map kind of works, there is an interesting stack trace somewhere, but this is awesome progress :D
2022-02-08: So I forgot to add an entry to the logbook yesterday - switching the maps now works. NPCs are now also part of the Map definition.
			Startup - as always - will need to be handled a little bit differently. Now, moving from map to map without having npc artefacts on the drawn map are next.
2022-02-09:	so moving from map to map persists the NPCs now. Horray, something I can do better than ultima V :D
			Also, loading NPCs from XML into Map also works.
2022-02-10: so I had a bug where the player was added to the current map again for each switch.
			So what do we try now?
			Lets check whether we can make weather go away indoors :D
			So weather none has a black icon, but it will not update immediately, so weather is broken.
			Yes, weather is definitely broken. This is the first of the threaded systems I wrote about two years ago and hell what did I do there?
			So: each map has a weather. 
			No Weather is also weather, not just a type.
2022-02-11:	yes, weather is horribly broken. what did i think of when i did that???
2022-02-12:	weather is still broken so what of.
			OK, weather is no longer broken. Its not yet perfect. I need to change this more like Animation system, should be easier to implement.
			So I am thinking about adding yet another layer of images on top.
			Will be snow or hail or rain images, to draw on top of the whole thing.
			So the images are created and are added. if the weather is rain or snow or hail, the images are drawn over the foreground.
			Also, map switching is very fast now, as the n/e/s/w connections are simply just created at game start.			
			but currently they are not necessary at all, as this is part of the map. Not sure actually if this is not necessary at all.
			Need to go through the code and check where I do lazy inits and where I dont. I think I am mixing.
2022-02-13:	tried to get android studio to run morgaelin - but ugh, this is awful. Asking Slashie for help
			fiddled around a little bit, map calculation still had a bug where the map position was not set during parsing the xml, but afterwards when re-calculating the nesw connections.
			how not to do it - one method for one thing.
			implemented armor, weapons utility items in separate files and XML parsers. might be overkill but the types are different enough.
2022-02-14:	so I have figured out that with the "background images", I have broken my own design. This is actually why I have created the TileType Class.
			So how about refactoring? Maptile extends animatedrepresentation and loads the images on startup?
			removed tiletype class. Added things for equipment and the like, broke map transition, somewhere? somehow?
			This tells me one thing: I need test cases. automated test cases.
			This tells me, dont do as much copy and paste.
2022-02-15:	So I implemented wearItem/WieldWeapon, removeWeapon/RemoveArmor/removeArmorPosition and Inventory. and GetItem and DropItem :D
			All of this definitely needs more work, but currently this is good enough. Need to think about the UI anyhow - will be U6 style currently.
			Do not think I can manage with a real paperdoll.
			So I have barged my way through some dialog code: in essence, calling super in a dialog is stupid.
			you need to define everything on its own level.
			But I solved the issue, opaque is the issue, this of course needs to be true, not false.
			Still to fix: why do the buttons not always appear right away in a fucking three control dialog?
			OK, me being stupid again.
			To do soon: https://stackoverflow.com/questions/22266506/how-to-add-image-in-jlist
2022-02-16:	so I worked some more on inventory & items yesterday. 
2022-02-17:	inventory dialog list is showing item + item name now.
			i can place items on the ground now.
			trying to identify the tile under the cursor.
			So what a day: I can now get items (the action is triggered before the mouse is pressed still),
			they are removed from the map, hence not drawn onto the UI, and appear in inventory.
			Awesome :D
			The fine print needs some more work (i.e. cursors, engine states and so on).
			But this is basically the basis for Talk, attack, drop and get.
			Next stop, equipment dialog? Or perhaps rather do a better listcellrenderer?
2022-02-18:	fiddling around with state - not much progress there right now.
			refactored cursor handling and moved it all to cursorutils which basically holds the cursor state now.
			Not sure how well this will work with the dialogs, but lets see how long there are dialogs.
			So after changing cursor to 48x48 and updating the calculation a little bit, this already looks much better.
2022-02-19:	worked a little bit on idletimer. This is off somewhere. Now its not off anymore. If I calculate the cursor in one method, this one needs to be correct :D
			so how about turn? is turn something global or rather local for the map?
			Do maps contain turns? i.e. does retract turn work on map level or on game level?
			perhaps make both possible and test both.
			Another thing - cursor state - best guess ist hat all cursor state is done in a separate class, not in Mainwindow.
			This is done now, but perhaps a game state class is needed? or really a statemachine class which keeps track of all state?
			UI State machine rather- but what is that? A Controller :D
			Now when getting and mouse is outside of grid, cursor is centered on player.
			ESC is still going somewhere somewhen, not sure about this.
			So inventory dialog has some nice popup now with a list selection model and a listselection class.
			So many classes, but well, this is MVC after all.
			Ok, so selection directly lands at the item in the model of the list and this works.
			Awesome.
			Next thing to do: implement equip (should be easy) and drop (close dialog, open selection, pause .... argh!)
			OK, so equip already works, wonder whether this will also work for NPCs, who dont have an inventory dialog.
			The encapsulation is kind of nice, but there are three listener classes right now, this need to go into one.
2022-02-20:	so there is one listener class for the inventory pane now. Big achievement.
			and list selection events are only fired once now. awesome.
			implemented visibility range in map and xml and test maps. 
			next stop: implementing more dark tiles around the player :D
			ring of darkness is implemented.
			PaintComponent() method is awesome.
			Only question is: when to paint what, currently these are just layered on top without any optimization
			not sure if its really necessary.
			So switching from 7 to 15 tiles was working without any issues.
			So I did some reading on brightness of images, but basically just copied code.
			Will try to figure it out with visibility. Instead of turning black, brighten up surroundings and make less so with distance :D
			Works. Great. Wondering how much CPU/GPU cycles this really needs.
			So NPCs will pick up items now.
			I have realized: The event -> action chain is horribly broken.
			Need to separate between UI Events and Game Actions better.
			UI events are triggered by mouse or keyboard events.
			These lead to game actions which can also be called by NPCs or test cases.
2022-02-21:	so move all item handling from map to tile? how about creating an item factory today?
			the item does not need to know where it is, the tile needs to know.
			also need to fix the XML parser bug. Ok, this does not work, why?
			the item does not know any longer, as does map. only the tile knows.
			so i did not achieve much today apart from breaking some things and then mending them.
			foreground and background animation use the full range of images now. there were two errors there. 
			0 is also valid and only double used to non-animation. I do not dare trying out what happens if I turn off animations.
			the paintComponent() looks a little bit better now and also a little faster and more organized, but this will need to go
			into various sub methods sooner or later.
			so i have figured out that animation system is the repaint() trigger as it is what happens most often.
			so the refresh amount is at 200ms now, that means 5 times per second.
			if there should be even more fluid motions, then it needs to go down even more.
			Question is whether the actual repaint cycle should not be handled by something else which just catches all state and repaints
			wondering whether that should not work better for projectiles, but I guess these can be threaded differently anyhow as
			these will not follow tiles but actual pixels instead. hopefully.
2022-02-22:	refactored paintComponent in gridcanvas because it was high time to do so. looks much better now and still works.
2022-02-23:	currently out of ideas and out of steam what to work on. i do not want to touch reworking the event and action part.
			so lets add some attributes to abstractentity - more classes! Zstats Dialog!
			So Statsdialog is working, it also shows the correct data now. Granted its more of the same, but that gives the possibility to add icons again
			making it much nicer.
			Now to think of additional stats... but some success at least. and about 10 additional classes.
2022-02-24:	So Stats Dialog has nice looking Icons now and they resize automatically based on Font Size. 
			tempted to try out the scaling library and just scale everything to 64 pixels.
			started on drag and drop. why? need this for equipment and need it for inventory container drag'n'drop.
2022-02-26:	so what does a container need? a separate dialog? can I reuse inventory as general class for both player, npc, and container?
2022-02-27:	container work, some container work - drag drop into container.
			So container items work, putting things into it at least works. The other way round still needs to be done.
			Double clicking on the bag opens the bag's inventory which is re-using inventory.
			Nice little progress! :)
2022-02-28:	so I have drag images now working, looking to properly understand how drag drop really works, more like the execution of methods.
			based on that, i can implement getting things out of a bag again :D
2022-03-02:	After a few fruitless days: So I do not understand how drag and drop really works. I can drag'drop stuff into the bag, but I cannot get it out again.
			Also, I need to be able to drag'drop stuff back onto the grid out of the containers.
			No idea how to do this.
			Anyways, I solved the problem of having commands consist of keyboard and mouse events.
			Next thing to do is drop command from inventory.
			D action -> open dialog -> double click item, close dialog, make cross, finish action
			And dropping works.
			No drag drop dropping yet, but that is shelved for now.
2022-03-03:	fixed the bug with drag drop where a drop removed all instances of an item from inventory but only added one to bag.
			removeall really does that as the docs say :D
2022-03-06:	So I implemented Talk and Talkdialog over the last few days and I am running into an XML issue with Sax2 parser.
			I have no idea why this works for all other fields but does not work for newly added ones in both map and npc.
			It is beyond me at the moment.
			But that is something for another time to figure out.
			OK, so Simon told me that exportDone contains the source of the drag, now I need to know the target of the drag, then this should - could work.
2022-03-07:	so i have managed a small thing today so far - dialogs dont open when there is already a dialog open.
2022-03-08:	so drag'n'drop between dialogs and within containers is working now properly. finally. extend AbstractListModel instead of implementing ListModel is key.
			firing additional events and removing the datalistener interface was key as well. now everything works as it should. 
			I can still add the bag to itself, that i need to take care of somewhere.
			So I can drag items onto the grid now :D:D:D
			Switched movement with mouse onto the right mouse button as I want to have dragndrop with the left.
			Perhaps this will switch, perhaps this will be configurable. We will see!
			Good progress!
2022-03-09:	and I can drag drop across the grid as well and from the grid into a container dialog and inventory.
			This is awesome.
			Do I want to drag into a container on the ground? not sure actually.
			Will need to check the visibility of items on the ground.
			Will also need to check whether the maptile simply does not get an inventory as to reuse the class even more.
			So there is a problem with mouse handling and drag drop as expected.
			Now getting creates a Drop? What the? How?
			But that is for tomorrow or for the weekend or next time.
2022-03-10:	so drag and drop now works about everywhere for anything.
			I can also drop onto the player now. Awesome.
			So now I am trying to get the ultima 4 map to load :D
			So no success with the map, but at least I got some refactoring done in entity.
			Problem is with mouse movement and drag drop, or rather dropping dialog and then drag dropping
			something is amiss there but I dont know yet.
			Something for the future to take care of.
			Oh todos: setup git, setup intellij community edition.
2022-03-11: moved to intellij and git.
            additional open topics: so a drop or a get for that matter does not "complete".
            problem is that currently only another non-moving command is kind of ending the existing command.
            not sure how to tackle this yet.
            so i have converted the u4 map.
            need to add a layer on top of map.
            for towns and so on.
            that way i can get caravans and moving things to enter.
            write map to xml is almost done.
2022-03-12: so I have successfully imported the u4 general terrain map as game map. Its also residing as XML.
            need to think about how to deal with the additional layers.
            So all tile types are blocking or not now.
            reimplemented NPC xml parsing as separate class and lo and behold, if you do it correctly it works.
            Also good point of doing switch statements instead of else if nonsense.
2022-03-13: So I have fixed part of the XML nonsense by updating and changing the code and actually making it easier.
            Lets see how this works out in the end.
            Not sure if i do not need a "create instance from Prototype" way, or whether this works as it should.
            I *think* add() in Lists copies the object, so this would actually work fine.
            Fixed the talk dialog to work at least.
            Do not like the way this is structured yet - this has to change.
            So list add() only adds copies, that means that I need to do a lot of new constructors :D
            Already solved it for map and npcs. Lets see about items.
2022-03-14: so talk dialog now closes when bye is uttered.
            Will need to make sure that the action properly closes when this is done.
            Same issue with get and drop and basically all two-step actions.
            Talk and Get are somewhat fixed, but need more work.
            Drop might work. Need to check: do not drop on blocked maptiles.
            Where to do this?
2022-03-15: mouse movement via drag is fixed now.
            refactored a bit the calculate cursor part.
            I would like to make sure that this is called everywhere automatically.
            with each command, with each click or release.
            issue was that i had a mix of relative and absolute locations as input for the cursor calculation.
            as as my own comment states: stupid to rely on the state of the cursor which command to do.
            but it works again.
            Next stop: fix some more drag and drop. I do not understand yet as to why a reject drag is ignored.
            the item disappears sure, but this is a bit weird. why are there nice helper methods if they do squat.
2022-03-16: working on furniture - items are one thing furniture another. they can be a lightsource.
2022-03-17: so I have a working furniture - which caused me to implement lighting and light ranges.
            This is now working.
            Next thing to do is to integrate this with darkness, which is going to be interesting.
            need to completely rewrite this some day, currently i am writing on top of each other
            where I could go tile by tile and write all what's necessary.
2022-03-18: So I have added visibility again and made it work with the light effects. In essence:
            all is dark apart from the area around the player and the area around the light source.
2022-03-19: Did some Intellij refactoring.
            Implemented Game time and map values for that.
            Also implemented visibility range based on game time.
            Will probably need to adjust the ranges a little to look nicer, currently its flat int ranges.
2022-03-20: Reworked the weather system, will probably disable the async weather system, although
            it is more like ultima IV and V.
            Not sure how to do this though yet - the weather system is global but whether there is a fixed weather
            (in towns or desert maps for instance or in caves), this I need to figure out better.
2022-03-21: So I fixed a "bug" with ESC handling - tooltips were the culprit.
            Removed all tooltips and lo and behold, no focus losing anymore.
            But will make sure to have it returned to Gridcanvas.
            Next stop: finish implementing talk.
            Based on talk, will need to think about checkpoints: how to define them, how to add them, how to remove them?
            Small code reduction: removed pointless window listener from WindowClosingAction.
2022-03-22: so talk dialog now closes only after bye has been said and enter is pressed again.
2022-03-30: vacation break over. so what did i do? Implemented move command. teleporting will not work.
            moving first x then y works, a* implementation needs work, also need to check look ahead and make sure i
            can open blocked doors again, but for that i need a better map.
            move also does not have a delay yet, so the commands are run but instantly performed.
            no matter, good progress.
2022-04-01: did not do much yesterday and today apart from some minor updating code to modern versions.
            oh, the main thing i did is to make move work properly. command queue is filled and cleared with a timer with
            a proper delay. So move to is kind of finished.
            Now I have everything in place for a proper a* implementation or at least an approximation and schedules.
2022-04-03: so i took a astar implementation which works from github. it now works also the second time it is run.
            problem was as usually my own code. Now I need to figure out, where the issue is for sometimes, the correct
            list of actions is not created.
            I probably should create a priorityqueue instead of my command queue, or rather subclass it.
            Oh, and I just realized that I need to re-asses the move to after each command for the reality might have
            changed (npcs move, doors close and so on). need to either have just accept the clashes, or I do a full
            recursive approach. Probably the former.
            Ok, played around with it way more than I should have. Not working the way I would like it to have,
            therefore I will go back to the easy way and try to get this running, tomorrow.
            I.e. fill up the queue, run the queue and hope for no collisions on the way.
2022-04-04: so i had yet another bug in the way of setting up the queue - I always took the current map position.
            This of course does not work, need to take future map position into account.
            This now works. I am so good, if I do not stumble over my own feet.
            Does this always work? No, of course not. Will it always work? No, of course not.
            Lets see how this will turn out with NPC schedules. Need to think of a way there.
            I guess I will have to hardcode a few of these.
            Oh, and with lighting and furniture drawing, I had forgotten to check the PC, as it is not an NPC.
            Easy fix, luckily, my tools and systems work very well by now.
2022-04-05: started working on scheduling engine - I can post events with changed events based on minute and so on.
            now need a way to define schedules. perhaps use game times? perhaps use a game time? not sure yet.
            And I have at least a basic running schedule. The framework is a little bit icky and I might need to
            remove the distinction between action and event sooner or later, but for now it still holds :D
            And perhaps it will. Everything was working apart from a damned auto-generated method which returned 0.
2022-04-08: so now I have two ways of ranged attack - one that follows tiles (might actually be good enough already)
            and one that follows strictly pixels :D
2022-04-09: ranged attack works kind of - will need to optimize it, will need to extend missile to have a miss and hit
            image that is drawn over the target.
            there still is a bug that the state is not finished, i.e. the other NPCs do not move. not sure where that is
            but I will find it. There will come a time where I need to refactor a lot of things, this is going to be
            painful but I will move this to a later date.
            Now I can draw basically firebreath as well, or lasers :D
2022-04-11: a day off for programming really - so I found a bug that the missiles were not removed properly.
            this was because the line calculation is trimmed to draw every 5 entries. if the last entry was removed,
            the missile never finished its run so to speak. this is now fixed, if the line is empty, the missile is done
            as well.
2022-04-28: so I had a two week break - still have not solved the missile issue. Not sure currently as to how I could.
            but: implemented some attack calculation, solely based on DEX. Guess armor will have to have a point in
            reducing damage only.
            But hey, progress, again.
            The last commit also includes drawing the explosion png upon successful hit - i will need make this more
            active, or even have a line of images.
2022-05-06: so a small thing - I updated the missile target to always hit the middle of the tile in order to center the
            target animation - will need to think of a way to have target animation extended with pauses.
            Also, implemented a basic health and level system with some attack calculation.
2022-05-08: Updated CommandQueue to fully support the Queue protocol.
2022-06-01: holdequipment needs to go, replaced by a shield and a weapon slot.
            wield weapon now does that.
            implemented basic attack damage calculation.
2022-06-02: need to think how to differentiate between ranged and melee attacks. Where to store this? check the item type?
            store it on entity?
2022-06-04: today worked on melee attacks and limiting the crosshair movement outside of the tile limit. might be a topic
            for mid-range weapons (infamous U4 halberd, or U5 halberd) later on. Not finished, but I think I have the
            idea how to do it.
2022-06-05: implemented melee attack range. This is working now, the crosshair stays inside the correct tiles.
            also works with bigger range for short range or mid range weapons. I like that my frameworks kind of work already.
            Also refactored moveMouse to CursorUtils, has nothing to do with Controller.
2022-06-06: some minor refactoring - removed Game reference from animation system.
            removed cursor centering code and replaced with cursorUtils method.
2022-06-09: currentAction in MainWindow was not emptied if the command was cancelled. This lead to limitCurorRange
            staying active. Also was not cancelled after attack was done, so movement was hindered.
2022-06-12: updated attack to also work for NPCs, have found out that making a difference between players and npcs is
            a problem. now npc is looking for a npc on the map where the player is but does not find anything.
            i need to update this to also include player. but if i work through this, I can have npcs attack each other.
            But it does not crash anymore.
            Also, bugfix for setting attack crosshair and tile for melee attack.
            Need to think of how to switch the image and for how long.
            I think not the missile needs to switch the image, but the target needs to depending on whether it is hit or
            miss.
2022-06-14: so i have updated attack in a way that the victim has an image change for a hit (not yet for a miss).
            still dont like the way this is set up.
            added animation cycles a bit and added event for movement to update graphics.
            wonder how many repaints i can do or need to do, current for each movement of each entity a repaint is called.
            this should not hurt with modern double buffering, but still it feels icky.
            updated space action to post a playermoved event to trigger repaint instead of relying on the animation repaint.
2022-06-27: holiday break over. updated splash screen to actually run during the loading time of the game instead of fake
            before. also updated splash screen to have a shiny :D progress bar thats kind of calculated properly :D
2022-06-28: so I have moved attack to NPC and AbstractEntity, this will need to be disentangled some more. But basically,
            NPC will attack the player once set to aggressive. will need to implement moving towards the player.
2022-07-01: just a few minor changes, but NPC now sets attacking player as victim and will attack back.
            need to implement moving towards the player for instance if player moves away or uses ranged weapon.
2022-07-05: calculated map adjaciency for deciding between attack and move towards victim.
            added simple "move towards victim". This still has a bug.
2022-07-11: players now can range attack npcs and npcs can at least shoot back at the player if out of melee range
            (and has a ranged weapon). open todos: draw missiles one after the other. have turn really end after the
            missile has struck. definitely need to fix the AI behaviour in order to make npc with melee move towards
            player.
2022-07-13: movement towards the player in case of melee finally works. Oh, and I had a bug that advancing the turn did
            not work due to a few return statements, I need to look at some basic java syntax I think.
2022-07-17: started on LifeForm interface in order to iterate over interface instead of entities and needing to cast
            those or reimplement or even care about the actual type.
            I hope this works :D Clean Commit to be safe. Sorry later :D
2022-07-17: switch to interface appears to be finished. Looking forward to easier working with it.
2022-07-18: so learned something new about java. abstract method in an abstract class. very useful.
            not much new functionality, but a lot of refactoring today.
2022-07-22: refactored entity out of the keyboardaction area.
2022-07-24: LoS does work in a simple implementation, I need a different algorithm for that, but the basic is
            working. Things to do here: proper calculation for the LoS. Also making it impossible to attack something
            that you cannot see. Perhaps a "hidden" property is needed for the maptile instead and then just draw the
            tile as black instead of doing it purely on UI level.
2022-07-24: added hidden property to the maptile which is check at mouse click for the target tile. You cannot interact
            with hidden tiles now.
2022-07-29: worked some more on music. Music now changes based on game state, only thing is, need to figure out a good
            way how to carry game state changes.
2022-08-05: lots of things changed - got rid of thread issues, got rid of concurrent modifications.
            music still not working.
            Ok, changed minor things in Animation Threads to have all only send messages if there is an ui.
            Changed all threads to do that.
            extended threadnames to have all thread names.
            extend thread controller to handle all threads.
            finally got soundplayer to work, guess two synchronized for the getter/setter were all that was missing.
            Also implemented increase/decrease Volume now.
            Need to think how to implement options menu.
            finally got rid of the exception with the missing weather images for foreground animation.
            also some clean up in image utils.
            small bug in sound player fixed.
2022-08-07: removed java FX. updated intelliJ, learned about the dependencies stuff in intellij.
            awesome. there is some log4j issue there which i do not comprehend yet, as i am on 2.x.
            added tika to parse files to figure out content type, probably useful for checking contents.
            using it for checking whether music is music at the moment.
2022-08-07: moved code to SoundUtils to make sure that something is only added when it is audio.
            cleaned up some classes.
            converted Ultima 7 OGG to wav for playing through sound system.
            every game state will need a directory with songs.
            these songs will be stored in separate lists.
            based on the game state, a map will point to the coresponding song.
            or so,
            i.e. Gamestate as key -> arraylist of paths to play.
2022-08-08: implemented songListMap as songbook basically that just takes all songs in different array lists.
            as the songs are classified already, this works like a charm.
            implemented additional game states, that were missing.
            moved a method from game to threadcontroller.
            updated soundplayer to do as it should do (even if the code looks unwieldly atm).
            need to implement better game state that tracks, how many npcs on the current map are aggressive to me.
            or alive? or both? and dependent on that, the music will need to change, to check for victory or combat
            (if NPC is naturally aggro)
2022-08-11: did some more changes to lifeform, to have more logic via interface than inheritance.
            sound player now works for victory.
            victory is implemented, meaning no hostile npc is on the map anymore. will need to sketch this out better,
            to have hostile within vicinity.
            oh, and npc death and death state is implemented. not in a good way yet, but there it is.
            and game state currently is within sound player and game which is not good and needs to go.
            implemented previousGameState for going back to the original music before battle/critical/Victory.
            need to implement critical :D
            implemented reverse check in turns to figure out whether the border of 3 turns to switch back music is
            fullfilled. not sure whether it is worth to trying to figure out a fluent change with fade out/fade in
            over passing time, as this will break the turn concept completely.
2022-08-12: thinking whether appearance cannot just be removed. Will I have a GUIless game? will I have an ascii
            interface? think not. What for?
2022-08-15: so the missile topic is solved for now. I have two additional threads, one for game loop and one for missile.
            this now works together with probably a lot of overhead, but this can be tackled later.
            next test: will a ranged attack by an npc also work? it should block PC movements as well.
            fine-tuning of missile trajectory is luckily only settings and not code anymore.
            realized that storing game state does not really work properly with the sound selection.
2022-08-16: introduced AIBehaviour to reduce code in Game (no logic!). there is a bug in attacking by the npc, it will
            only switch to ranged, once it was in melee range.
            also bug in idle timer, that is why there are sometimes two missiles cast, would never have seen this otherwise.
            music timer kind of works, still would prefer the current song to stop running if its victory.
            Introduced GameConfiguration and broke half of the game.
            No, not that, but found a dependence on checkImageSize. removed that.
            Game looks a little bit more cleaned up.
            Need to implement a better way how to store ideas and bugs and so on, but I am too lazy to set up anything
            real.
2022-08-17: so what did I do today? I implemented that you can move the cross-hair at least one tile on the grid.
            need to think where to put the switch of the mode change. and how to track it.
            Quequetimer was 7 seconds, wayy too long.
            reduced some code in main window. the mouse released/onmessageevent(Keyboard) methods are way too long.
            need to remove complexity and really switch out pure UI stuff (i.e. where is the mouse? what is under
            mouse cursor), just write this once, use everywhere.
            get rid of mouse event usage, work with standard way for standard problem.
            did some refactoring on game and mainwindow.
2022-08-19: so moving the cross-hair cursor with arrow keys now works so far. Attacking finishes it, ESC stops it.
            Need to think how many commands need this kind of navigation.
            Done for get.
            Definitely need to get code out of main window, this is way too much.
            Oh yeah, did turn off some useless logging in UI build. This is to be handled seperately.
            Big make actions handled better indepdendent whether they are done via mouse released or keyboard.
            Make more of the action framework there.
            Both mouse and keyboard deliver actions which are then run, but only in one way and not about three.
            MOVE might stay seperate.
2022-08-21: So player around a bit with sound and also combining keyboard and mouse input. Nothing committable though.
2022-08-22: trying to figure out how to reduce code for actions.
            Refactoring for keyboard and mouse input is done. haveNPCAction is moved to action itself.
            Worth a commit.
2022-08-23: introduced Look command, this now only pipes to log, found that there is a bug in draw furniture.
            Bug needs to be fixed. introduced bug file for keeping bugs.
            added a few new ideas.
2022-08-24: fixed furniture draw bug. it was a remnant of drawing weather on top of it which still worked.
            awesome isnt it?

